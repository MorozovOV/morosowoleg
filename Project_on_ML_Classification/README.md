# Проект 4. Пострение модели машинного обучения. Классификация.

## Оглавление  
[1. Описание проекта](README.md#Описание-проекта)  
[2. Какой кейс решаем?](README.md#Какой-кейс-решаем)  
[3. Краткая информация о данных](README.md#Краткая-информация-о-данных)  
[4. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)  
[5. Результат](README.md#Результат)    
[6. Выводы](README.md#Выводы) 

### Описание проекта    
Нам предоставили данные о последней маркетинговой кампании, которую проводил банк: задачей было привлечь клиентов для открытия депозита. Мы должны проанализировать эти данные, выявить закономерность и найти решающие факторы, повлиявшие на то, что клиент вложил деньги именно в этот банк. В случае успешного выполнения задачи мы поднимем доходы банка и поможем понять целевую аудиторию, которую необходимо привлекать путём рекламы и различных предложений.
:arrow_up:[к оглавлению](_)


### Какой кейс решаем?    
Построение модели машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет.

**Метрика качества**     
Результат оценивается по метрикам accuracy и F1.

**Что практикуем**     
Разведывательный анализ данных, очистка данных, преобразование данных, отбор данных для построения модели машинного обучения, подбор оптимальной модели машинного обучения, подбор гиперпараметров модели.

**Использованные библиотеки Python**
pandas
numpy
matplotlib
seaborn
sklearn
optuna


### Краткая информация о данных
В качестве исходных данных мы использовали csv-файл (https://cloud.mail.ru/public/zfmi/18vaiGMvx), который содержит следующую информацию:

**Данные о клиентах банка**:

* age (возраст);
* job (сфера занятости);
* marital (семейное положение);
* education (уровень образования);
* default (имеется ли просроченный кредит);
* housing (имеется ли кредит на жильё);
* loan (имеется ли кредит на личные нужды);
* balance (баланс).

**Данные, связанные с последним контактом в контексте текущей маркетинговой кампании**:

* contact (тип контакта с клиентом);
* month (месяц, в котором был последний контакт);
* day (день, в который был последний контакт);
* duration (продолжительность контакта в секундах).

**Прочие признаки**:

* campaign (количество контактов с этим клиентом в течение текущей кампании);
* pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);
* previous (количество контактов до текущей кампании)
* poutcome (результат прошлой маркетинговой кампании).

**Целевая переменная** - *deposit*, которая определяет, согласится ли клиент открыть депозит в банке. Именно её мы будем пытаться предсказать в данном кейсе.
  
:arrow_up:[к оглавлению](README.md#Оглавление)


### Этапы работы над проектом  
Работа над проектом проходила в пять этапов.

На первом этапе происходила загрузка данных, первичное ознакомление с датасетом и очистка данных.

На втором этапе был проведён разведывательный анализ данных. Был проведён анализ целевой переменной на предмет сбалансированности, проанализированы числовые и категориальные признаки, установлены зависимости в данных.

Третий этап был посвящён преобразованию данных. Было произведено кодирование категориальных признаков; установлена корреляция признаков с целевой переменной, на основе чего методом SelectKBest были отобраны топ-15 признаков, наиболее сильно коррелирующих с целевой переменной. После этого данные были разделеные на тренировочную и тестовую выборки, произведена нормализация данных.

На четвёртом этапе были построены модели машинного обучения на основе логистической регрессии и решающих деревьев с параметрами по умолчанию. Было установлено, какие факторы влияют на переобучение модели.

На пятом финальном этапе были использованы ансамбли моделей "случайный лес", градиентный бустинг, а также стекинг из моделей решающего дерева, логистической регрессии и градиентного бустинга с логистической регрессией в качестве метамодели. Таже был произведён подбор гиперпараметров при помощи метода Optunа.

:arrow_up:[к оглавлению](README.md#Оглавление)


### Результаты:  
В результате проделанной работы было установлено, что наилучшие показатели достигаются при помощи случайного леса с подобранными при помощи метода Optuna гиперпараметрами. Лучшие показатели метрик, которых удалось достичь: f1 = 0.822, accuracy = 0.831.

:arrow_up:[к оглавлению](README.md#Оглавление)


### Выводы:  
Проведённая работа способствовала построению достаточно точной модели машинного обучения. Цель проекта достигнута.

:arrow_up:[к оглавлению](README.md#Оглавление)


Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарен, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами
